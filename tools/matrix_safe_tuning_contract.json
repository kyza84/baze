{
  "schema_version": "matrix.safe_tuning_contract.v1",
  "description": "Safe tuning envelope for user presets. Keys outside this allow-list are blocked.",
  "allowed_keys": {
    "AUTO_TRADE_TOP_N": {
      "type": "int",
      "min": 8,
      "max": 80,
      "sensitivity": "medium",
      "importance": "flow"
    },
    "AUTO_TRADE_ENTRY_MODE": {
      "type": "enum",
      "values": [
        "single",
        "top_n",
        "all"
      ],
      "sensitivity": "high",
      "importance": "routing"
    },
    "MAX_OPEN_TRADES": {
      "type": "int",
      "min": 2,
      "max": 12,
      "sensitivity": "high",
      "importance": "risk"
    },
    "MAX_BUYS_PER_HOUR": {
      "type": "int",
      "min": 20,
      "max": 220,
      "sensitivity": "high",
      "importance": "flow"
    },
    "MAX_TX_PER_DAY": {
      "type": "int",
      "min": 0,
      "max": 5000,
      "sensitivity": "high",
      "importance": "flow"
    },
    "ANTI_CHOKE_ALLOW_SYMBOL_COOLDOWN_BYPASS": {
      "type": "bool",
      "sensitivity": "high",
      "importance": "diversification"
    },
    "ANTI_CHOKE_ALLOW_SYMBOL_FATIGUE_BYPASS": {
      "type": "bool",
      "sensitivity": "high",
      "importance": "diversification"
    },
    "ANTI_CHOKE_ALLOW_SYMBOL_STRICT_BYPASS": {
      "type": "bool",
      "sensitivity": "high",
      "importance": "diversification"
    },
    "MIN_TOKEN_SCORE": {
      "type": "int",
      "min": 15,
      "max": 95,
      "sensitivity": "medium",
      "importance": "entry_quality"
    },
    "MARKET_MODE_STRICT_SCORE": {
      "type": "int",
      "min": 15,
      "max": 95,
      "sensitivity": "high",
      "importance": "entry_quality"
    },
    "MARKET_MODE_SOFT_SCORE": {
      "type": "int",
      "min": 10,
      "max": 90,
      "sensitivity": "high",
      "importance": "entry_quality"
    },
    "MIN_EXPECTED_EDGE_PERCENT": {
      "type": "float",
      "min": 0.05,
      "max": 3.0,
      "sensitivity": "high",
      "importance": "entry_quality"
    },
    "MIN_EXPECTED_EDGE_USD": {
      "type": "float",
      "min": 0.0005,
      "max": 0.05,
      "sensitivity": "high",
      "importance": "entry_quality"
    },
    "V2_ROLLING_EDGE_MIN_USD": {
      "type": "float",
      "min": 0.0005,
      "max": 0.05,
      "sensitivity": "high",
      "importance": "entry_quality"
    },
    "V2_ROLLING_EDGE_MIN_PERCENT": {
      "type": "float",
      "min": 0.05,
      "max": 3.0,
      "sensitivity": "high",
      "importance": "entry_quality"
    },
    "V2_CALIBRATION_ENABLED": {
      "type": "bool",
      "sensitivity": "high",
      "importance": "routing"
    },
    "V2_CALIBRATION_NO_TIGHTEN_DURING_RELAX_WINDOW": {
      "type": "bool",
      "sensitivity": "medium",
      "importance": "routing"
    },
    "V2_CALIBRATION_EDGE_USD_MIN": {
      "type": "float",
      "min": 0.0005,
      "max": 0.05,
      "sensitivity": "high",
      "importance": "entry_quality"
    },
    "V2_CALIBRATION_VOLUME_MIN": {
      "type": "float",
      "min": 5.0,
      "max": 450.0,
      "sensitivity": "medium",
      "importance": "entry_quality"
    },
    "EV_FIRST_ENTRY_MIN_NET_USD": {
      "type": "float",
      "min": -0.002,
      "max": 0.02,
      "sensitivity": "high",
      "importance": "entry_quality"
    },
    "EV_FIRST_ENTRY_CORE_PROBE_EV_TOLERANCE_USD": {
      "type": "float",
      "min": 0.001,
      "max": 0.01,
      "sensitivity": "high",
      "importance": "entry_quality"
    },
    "SAFE_MIN_VOLUME_5M_USD": {
      "type": "float",
      "min": 5.0,
      "max": 8000.0,
      "sensitivity": "medium",
      "importance": "entry_quality"
    },
    "SAFE_MIN_LIQUIDITY_USD": {
      "type": "float",
      "min": 100.0,
      "max": 600000.0,
      "sensitivity": "medium",
      "importance": "entry_quality"
    },
    "MIN_LIQUIDITY": {
      "type": "float",
      "min": 100.0,
      "max": 100000.0,
      "sensitivity": "medium",
      "importance": "source_quality"
    },
    "SAFE_MIN_AGE_SECONDS": {
      "type": "int",
      "min": 0,
      "max": 3600,
      "sensitivity": "high",
      "importance": "entry_quality"
    },
    "TOKEN_AGE_MAX": {
      "type": "int",
      "min": 1800,
      "max": 21600,
      "sensitivity": "medium",
      "importance": "source_quality"
    },
    "SEEN_TOKEN_TTL": {
      "type": "int",
      "min": 300,
      "max": 21600,
      "sensitivity": "medium",
      "importance": "source_quality"
    },
    "PAPER_TRADE_SIZE_MIN_USD": {
      "type": "float",
      "min": 0.1,
      "max": 2.0,
      "sensitivity": "high",
      "importance": "risk"
    },
    "MIN_TRADE_USD": {
      "type": "float",
      "min": 0.01,
      "max": 2.0,
      "sensitivity": "high",
      "importance": "risk"
    },
    "ENTRY_A_CORE_MIN_TRADE_USD": {
      "type": "float",
      "min": 0.1,
      "max": 2.5,
      "sensitivity": "high",
      "importance": "risk"
    },
    "PAPER_TRADE_SIZE_MAX_USD": {
      "type": "float",
      "min": 0.3,
      "max": 2.5,
      "sensitivity": "high",
      "importance": "risk"
    },
    "PAPER_MAX_HOLD_SECONDS": {
      "type": "int",
      "min": 60,
      "max": 900,
      "sensitivity": "medium",
      "importance": "exit"
    },
    "HOLD_MIN_SECONDS": {
      "type": "int",
      "min": 10,
      "max": 480,
      "sensitivity": "medium",
      "importance": "exit"
    },
    "HOLD_MAX_SECONDS": {
      "type": "int",
      "min": 30,
      "max": 1200,
      "sensitivity": "medium",
      "importance": "exit"
    },
    "PAPER_PARTIAL_TP_TRIGGER_PERCENT": {
      "type": "float",
      "min": 0.3,
      "max": 8.0,
      "sensitivity": "medium",
      "importance": "exit"
    },
    "PAPER_PARTIAL_TP_SELL_FRACTION": {
      "type": "float",
      "min": 0.1,
      "max": 0.9,
      "sensitivity": "medium",
      "importance": "exit"
    },
    "NO_MOMENTUM_EXIT_MAX_PNL_PERCENT": {
      "type": "float",
      "min": -0.5,
      "max": 1.2,
      "sensitivity": "medium",
      "importance": "exit"
    },
    "WEAKNESS_EXIT_PNL_PERCENT": {
      "type": "float",
      "min": -8.0,
      "max": -0.2,
      "sensitivity": "high",
      "importance": "risk"
    },
    "MAX_TOKEN_COOLDOWN_SECONDS": {
      "type": "int",
      "min": 0,
      "max": 3600,
      "sensitivity": "medium",
      "importance": "flow"
    },
    "HEAVY_CHECK_DEDUP_TTL_SECONDS": {
      "type": "int",
      "min": 0,
      "max": 120,
      "sensitivity": "medium",
      "importance": "routing"
    },
    "STOP_LOSS_PERCENT": {
      "type": "float",
      "min": 1.0,
      "max": 8.0,
      "sensitivity": "high",
      "importance": "risk"
    },
    "PROFIT_TARGET_PERCENT": {
      "type": "float",
      "min": 0.6,
      "max": 20.0,
      "sensitivity": "medium",
      "importance": "exit"
    },
    "V2_ENTRY_EXPLORE_MAX_SHARE": {
      "type": "float",
      "min": 0.05,
      "max": 0.7,
      "sensitivity": "high",
      "importance": "routing"
    },
    "V2_UNIVERSE_NOVELTY_MIN_SHARE": {
      "type": "float",
      "min": 0.05,
      "max": 0.9,
      "sensitivity": "high",
      "importance": "routing"
    },
    "V2_QUALITY_SYMBOL_MAX_SHARE": {
      "type": "float",
      "min": 0.05,
      "max": 0.5,
      "sensitivity": "high",
      "importance": "diversification"
    },
    "V2_QUALITY_SYMBOL_MIN_ABS_CAP": {
      "type": "int",
      "min": 1,
      "max": 10,
      "sensitivity": "high",
      "importance": "diversification"
    },
    "V2_QUALITY_SYMBOL_REENTRY_MIN_SECONDS": {
      "type": "int",
      "min": 0,
      "max": 3600,
      "sensitivity": "medium",
      "importance": "diversification"
    },
    "SYMBOL_CONCENTRATION_MAX_SHARE": {
      "type": "float",
      "min": 0.05,
      "max": 0.5,
      "sensitivity": "high",
      "importance": "diversification"
    },
    "AUTO_TRADE_EXCLUDED_SYMBOLS": {
      "type": "csv_symbol_list",
      "max_items": 40,
      "sensitivity": "low",
      "importance": "routing"
    },
    "ENTRY_REQUIRE_POSITIVE_CHANGE_5M": {
      "type": "bool",
      "sensitivity": "medium",
      "importance": "entry_quality"
    },
    "ENTRY_MIN_PRICE_CHANGE_5M_PERCENT": {
      "type": "float",
      "min": -2.0,
      "max": 8.0,
      "sensitivity": "medium",
      "importance": "entry_quality"
    },
    "ENTRY_MIN_VOLUME_5M_MULT": {
      "type": "float",
      "min": 0.5,
      "max": 3.0,
      "sensitivity": "medium",
      "importance": "entry_quality"
    },
    "PAPER_ALLOW_WATCHLIST_SOURCE": {
      "type": "bool",
      "sensitivity": "high",
      "importance": "routing"
    },
    "WATCHLIST_ENABLED": {
      "type": "bool",
      "sensitivity": "high",
      "importance": "routing"
    },
    "WATCHLIST_REFRESH_SECONDS": {
      "type": "int",
      "min": 30,
      "max": 3600,
      "sensitivity": "medium",
      "importance": "routing"
    },
    "WATCHLIST_MAX_TOKENS": {
      "type": "int",
      "min": 5,
      "max": 120,
      "sensitivity": "medium",
      "importance": "routing"
    },
    "WATCHLIST_MIN_LIQUIDITY_USD": {
      "type": "float",
      "min": 5000.0,
      "max": 1000000.0,
      "sensitivity": "high",
      "importance": "entry_quality"
    },
    "WATCHLIST_MIN_VOLUME_24H_USD": {
      "type": "float",
      "min": 10000.0,
      "max": 5000000.0,
      "sensitivity": "high",
      "importance": "entry_quality"
    },
    "WATCHLIST_GECKO_TRENDING_PAGES": {
      "type": "int",
      "min": 1,
      "max": 5,
      "sensitivity": "medium",
      "importance": "routing"
    },
    "WATCHLIST_GECKO_POOLS_PAGES": {
      "type": "int",
      "min": 0,
      "max": 5,
      "sensitivity": "medium",
      "importance": "routing"
    },
    "PAPER_WATCHLIST_MIN_SCORE": {
      "type": "int",
      "min": 70,
      "max": 98,
      "sensitivity": "medium",
      "importance": "entry_quality"
    },
    "PAPER_WATCHLIST_MIN_LIQUIDITY_USD": {
      "type": "float",
      "min": 10000.0,
      "max": 500000.0,
      "sensitivity": "high",
      "importance": "entry_quality"
    },
    "PAPER_WATCHLIST_MIN_VOLUME_5M_USD": {
      "type": "float",
      "min": 10.0,
      "max": 20000.0,
      "sensitivity": "high",
      "importance": "entry_quality"
    },
    "PAPER_WATCHLIST_MIN_ABS_CHANGE_5M": {
      "type": "float",
      "min": 0.0,
      "max": 12.0,
      "sensitivity": "medium",
      "importance": "entry_quality"
    },
    "V2_SAFETY_BUDGET_ENABLED": {
      "type": "bool",
      "sensitivity": "high",
      "importance": "safety"
    },
    "V2_SAFETY_BUDGET_MAX_PER_CYCLE": {
      "type": "int",
      "min": 10,
      "max": 300,
      "sensitivity": "high",
      "importance": "safety"
    },
    "V2_SAFETY_BUDGET_PER_SOURCE": {
      "type": "source_cap_map",
      "max_items": 16,
      "min_value": 1,
      "max_value": 300,
      "sensitivity": "high",
      "importance": "safety"
    },
    "V2_SOURCE_QOS_ENABLED": {
      "type": "bool",
      "sensitivity": "medium",
      "importance": "routing"
    },
    "V2_QUALITY_SOURCE_BUDGET_ENABLED": {
      "type": "bool",
      "sensitivity": "high",
      "importance": "routing"
    },
    "ONCHAIN_ENRICH_RETRIES": {
      "type": "int",
      "min": 1,
      "max": 6,
      "sensitivity": "medium",
      "importance": "source_quality"
    },
    "ONCHAIN_ENRICH_RETRY_DELAY_SECONDS": {
      "type": "int",
      "min": 1,
      "max": 20,
      "sensitivity": "medium",
      "importance": "source_quality"
    },
    "V2_SOURCE_QOS_FORCE_DUAL_ENTRY": {
      "type": "bool",
      "sensitivity": "medium",
      "importance": "routing"
    },
    "V2_SOURCE_QOS_TOPK_PER_CYCLE": {
      "type": "int",
      "min": 20,
      "max": 600,
      "sensitivity": "high",
      "importance": "routing"
    },
    "V2_SOURCE_QOS_MAX_PER_SYMBOL_PER_CYCLE": {
      "type": "int",
      "min": 1,
      "max": 20,
      "sensitivity": "high",
      "importance": "routing"
    },
    "V2_SOURCE_QOS_COOLDOWN_SECONDS": {
      "type": "int",
      "min": 60,
      "max": 3600,
      "sensitivity": "medium",
      "importance": "routing"
    },
    "V2_SOURCE_QOS_MIN_PASS_RATE": {
      "type": "float",
      "min": 0.0,
      "max": 0.2,
      "sensitivity": "high",
      "importance": "routing"
    },
    "V2_SOURCE_QOS_MIN_EV_POSITIVE_RATE": {
      "type": "float",
      "min": 0.0,
      "max": 0.5,
      "sensitivity": "high",
      "importance": "routing"
    },
    "V2_SOURCE_QOS_MIN_OPEN_RATE": {
      "type": "float",
      "min": 0.0,
      "max": 0.3,
      "sensitivity": "high",
      "importance": "routing"
    },
    "V2_SOURCE_QOS_SOURCE_CAPS": {
      "type": "source_cap_map",
      "max_items": 16,
      "min_value": 1,
      "max_value": 600,
      "sensitivity": "high",
      "importance": "routing"
    },
    "V2_UNIVERSE_SOURCE_CAPS": {
      "type": "source_cap_map",
      "max_items": 16,
      "min_value": 1,
      "max_value": 600,
      "sensitivity": "high",
      "importance": "routing"
    },
    "PLAN_SOURCE_DIVERSITY_ENABLED": {
      "type": "bool",
      "sensitivity": "high",
      "importance": "routing"
    },
    "PLAN_MAX_SINGLE_SOURCE_SHARE": {
      "type": "float",
      "min": 0.2,
      "max": 1.0,
      "sensitivity": "high",
      "importance": "routing"
    },
    "PLAN_MAX_WATCHLIST_SHARE": {
      "type": "float",
      "min": 0.0,
      "max": 1.0,
      "sensitivity": "high",
      "importance": "routing"
    },
    "PLAN_MIN_NON_WATCHLIST_PER_BATCH": {
      "type": "int",
      "min": 0,
      "max": 20,
      "sensitivity": "high",
      "importance": "routing"
    },
    "PLAN_UNDERFLOW_ALLOW_HOLD": {
      "type": "bool",
      "sensitivity": "high",
      "importance": "routing"
    },
    "PLAN_UNDERFLOW_HOLD_MIN_SCORE": {
      "type": "int",
      "min": 0,
      "max": 95,
      "sensitivity": "high",
      "importance": "routing"
    },
    "V2_KPI_POLICY_MODE": {
      "type": "enum",
      "values": [
        "normal",
        "lock_zero_open"
      ],
      "sensitivity": "medium",
      "importance": "routing"
    },
    "SOURCE_ROUTER_MIN_TRADES": {
      "type": "int",
      "min": 4,
      "max": 40,
      "sensitivity": "medium",
      "importance": "routing"
    },
    "SOURCE_ROUTER_BAD_ENTRY_PROBABILITY": {
      "type": "float",
      "min": 0.35,
      "max": 0.95,
      "sensitivity": "high",
      "importance": "routing"
    },
    "SOURCE_ROUTER_SEVERE_ENTRY_PROBABILITY": {
      "type": "float",
      "min": 0.2,
      "max": 0.9,
      "sensitivity": "high",
      "importance": "routing"
    },
    "TOKEN_EV_MEMORY_MIN_TRADES": {
      "type": "int",
      "min": 2,
      "max": 30,
      "sensitivity": "medium",
      "importance": "entry_quality"
    },
    "TOKEN_EV_MEMORY_BAD_ENTRY_PROBABILITY": {
      "type": "float",
      "min": 0.35,
      "max": 0.95,
      "sensitivity": "high",
      "importance": "entry_quality"
    },
    "TOKEN_EV_MEMORY_SEVERE_ENTRY_PROBABILITY": {
      "type": "float",
      "min": 0.2,
      "max": 0.9,
      "sensitivity": "high",
      "importance": "entry_quality"
    },
    "PROFIT_ENGINE_ENABLED": {
      "type": "bool",
      "sensitivity": "high",
      "importance": "routing"
    }
  },
  "protected_keys": [
    "WALLET_BALANCE_USD",
    "WALLET_MODE",
    "AUTO_TRADE_ENABLED",
    "AUTO_TRADE_PAPER",
    "PROFILE_AUTOSTOP_ENABLED",
    "PROFILE_AUTOSTOP_MIN_RUNTIME_SECONDS",
    "PROFILE_AUTOSTOP_MIN_CLOSED_TRADES",
    "PROFILE_AUTOSTOP_MIN_REALIZED_PNL_USD",
    "PROFILE_AUTOSTOP_MIN_AVG_PNL_PER_TRADE_USD",
    "PROFILE_AUTOSTOP_MAX_LOSS_SHARE",
    "PROFILE_AUTOSTOP_MAX_DRAWDOWN_FROM_PEAK_USD",
    "PROFILE_AUTOSTOP_MIN_FAIL_SIGNALS",
    "TOKEN_SAFETY_FAIL_CLOSED",
    "HONEYPOT_API_FAIL_CLOSED",
    "SAFE_REQUIRE_CONTRACT_SAFE",
    "SAFE_REQUIRE_RISK_LEVEL",
    "ENTRY_FAIL_CLOSED_ON_SAFETY_GAP",
    "ENTRY_ALLOWED_SAFETY_SOURCES",
    "PAPER_WATCHLIST_STRICT_GUARD_ENABLED",
    "V2_POLICY_ROUTER_ENABLED",
    "V2_POLICY_FAIL_CLOSED_ACTION",
    "V2_POLICY_DEGRADED_ACTION",
    "MARKET_MODE_OWNS_STRICTNESS",
    "MARKET_MODE_ENTER_STREAK",
    "MARKET_MODE_EXIT_STREAK",
    "PAPER_RESET_ON_START",
    "PERSIST_TRADING_PAUSE_ON_RESTART",
    "CANDIDATE_SHARD_MOD",
    "CANDIDATE_SHARD_SLOT",
    "RUN_TAG",
    "BOT_INSTANCE_ID",
    "LOG_DIR",
    "PAPER_STATE_FILE"
  ],
  "blocked_prefixes": [
    "LIVE_",
    "PRIVATE_",
    "SECRET_",
    "API_KEY",
    "TELEGRAM_"
  ],
  "global_rules": [
    {
      "id": "trade_size_range",
      "left": "PAPER_TRADE_SIZE_MIN_USD",
      "op": "<=",
      "right": "PAPER_TRADE_SIZE_MAX_USD"
    },
    {
      "id": "hold_range",
      "left": "HOLD_MIN_SECONDS",
      "op": "<=",
      "right": "HOLD_MAX_SECONDS"
    },
    {
      "id": "market_mode_score_order",
      "left": "MARKET_MODE_SOFT_SCORE",
      "op": "<=",
      "right": "MARKET_MODE_STRICT_SCORE"
    }
  ]
}
